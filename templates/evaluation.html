<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ë©ï‰º∞ÂàÜÊûê - CNIRS</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>üìä Ë©ï‰º∞ÂàÜÊûê</h1>
            <p class="subtitle">Evaluation & Performance Analysis<br>Ê™¢Á¥¢Á≥ªÁµ±ÊïàËÉΩË©ï‰º∞</p>
            <nav class="nav">
                <a href="/" class="nav-link">ÊêúÂ∞ã</a>
                <a href="/compare" class="nav-link">Ê®°ÂûãÂ∞çÊØî</a>
                <a href="/expand" class="nav-link">Êü•Ë©¢Êì¥Â±ï</a>
                <a href="/evaluation" class="nav-link active">Ë©ï‰º∞ÂàÜÊûê</a>
                <a href="/about" class="nav-link">ÈóúÊñº</a>
            </nav>
        </header>

        <!-- Evaluation Control Panel -->
        <div class="eval-control-panel">
            <h2>üéØ Ë©ï‰º∞Ë®≠ÂÆö</h2>

            <div class="eval-config">
                <div class="config-group">
                    <label for="eval-query">Ê∏¨Ë©¶Êü•Ë©¢:</label>
                    <input type="text" id="eval-query" placeholder="Ëº∏ÂÖ•Ê∏¨Ë©¶Êü•Ë©¢..." value="Âè∞ÁÅ£">
                </div>

                <div class="config-group">
                    <label for="eval-models">Ë©ï‰º∞Ê®°Âûã:</label>
                    <div class="checkbox-group">
                        <label class="checkbox-item">
                            <input type="checkbox" value="tfidf" class="model-checkbox" checked>
                            <span>TF-IDF</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" value="bm25" class="model-checkbox" checked>
                            <span>BM25</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" value="boolean" class="model-checkbox">
                            <span>Boolean</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" value="bert" class="model-checkbox">
                            <span>BERT</span>
                        </label>
                    </div>
                </div>

                <div class="config-group">
                    <label for="eval-topk">Top-K ÊñáÊ™î:</label>
                    <input type="number" id="eval-topk" value="20" min="5" max="50" step="5">
                </div>

                <button id="run-eval-btn" class="btn btn-primary">‚ñ∂Ô∏è Âü∑Ë°åË©ï‰º∞</button>
            </div>
        </div>

        <!-- Loading Indicator -->
        <div id="eval-loading" class="loading" style="display: none;">
            <div class="spinner"></div>
            <p>Ë©ï‰º∞Ë®àÁÆó‰∏≠...</p>
        </div>

        <!-- Results Container -->
        <div id="eval-results" style="display: none;">
            <!-- Metrics Summary Cards -->
            <div class="metrics-summary">
                <h2>üìà Ë©ï‰º∞ÊåáÊ®ôÁ∏ΩË¶Ω</h2>
                <div id="metrics-cards" class="metrics-cards"></div>
            </div>

            <!-- Chart Controls -->
            <div class="chart-controls">
                <h3>üìä ÂúñË°®È°ØÁ§∫ÈÅ∏È†Ö</h3>
                <div class="control-options">
                    <label class="checkbox-item">
                        <input type="checkbox" id="overlay-precision" checked>
                        <span>ÁñäÂä† Precision@K ÂúñË°®</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="overlay-recall" checked>
                        <span>ÁñäÂä† Recall@K ÂúñË°®</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="overlay-f1" checked>
                        <span>ÁñäÂä† F1-Score ÂúñË°®</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="show-interpolated" checked>
                        <span>È°ØÁ§∫ 11-ÈªûÊèíÂÄº PR Êõ≤Á∑ö</span>
                    </label>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="charts-section">
                <div class="chart-container">
                    <h3>Precision @ K</h3>
                    <canvas id="precision-chart"></canvas>
                </div>

                <div class="chart-container">
                    <h3>Recall @ K</h3>
                    <canvas id="recall-chart"></canvas>
                </div>

                <div class="chart-container">
                    <h3>F1-Score @ K</h3>
                    <canvas id="f1-chart"></canvas>
                </div>

                <div class="chart-container">
                    <h3>nDCG @ K</h3>
                    <canvas id="ndcg-chart"></canvas>
                </div>

                <div class="chart-container">
                    <h3>F-beta Scores (Œ≤=0.5, Œ≤=2)</h3>
                    <canvas id="fbeta-chart"></canvas>
                </div>

                <div class="chart-container">
                    <h3>Precision at Recall Levels</h3>
                    <canvas id="p-at-r-chart"></canvas>
                </div>
            </div>

            <!-- Precision-Recall Curves -->
            <div class="pr-curve-section">
                <h2>üìâ Precision-Recall Curves</h2>

                <div class="pr-charts-grid">
                    <div class="chart-container-large">
                        <h3>ÂéüÂßã PR Êõ≤Á∑ö (Raw PR Curve)</h3>
                        <canvas id="pr-curve-chart"></canvas>
                    </div>

                    <div class="chart-container-large">
                        <h3>11-ÈªûÊèíÂÄº PR Êõ≤Á∑ö (11-Point Interpolated)</h3>
                        <canvas id="pr-interpolated-chart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Model Comparison Table -->
            <div class="comparison-table-section">
                <h2>üîç Ê®°ÂûãÊØîËºÉË°®</h2>
                <div id="comparison-table"></div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>&copy; 2025 CNIRS | Information Retrieval System | Educational Use</p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='js/evaluation.js') }}"></script>
</body>
</html>
